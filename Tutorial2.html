<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<!-- <meta name="viewport", content="width = device-width, initial-scale = 1"> -->
	<!-- Bootstrap sources -->
	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	<!-- <link rel="stylesheet" type="text/css" href="css/bootstrap.css"> -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<!-- Jquery -->
	<!-- <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script> -->
	<!-- Joyride CSS file -->
	<!-- <link rel="stylesheet" type="text/css" href="node_modules/jquery.joyride/jquery.joyride.css"> -->
	<!-- Joyride plugin -->
	<!-- <script src="node_modules/jquery.joyride/jquery.joyride.js"></script> -->
	<!-- Font Awesome icons -->
	<script src="https://use.fontawesome.com/releases/v5.0.7/js/all.js"></script>
	<!-- Page icon -->
	<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
	<!-- Page title (name on the tab) -->
	<title>Pave: the Canadian Job Explorer</title>
	<!-- stylesheet -->
	<link rel="stylesheet" href="css/main.css">
	<!-- Google fonts -->
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Raleway">
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Montserrat">
</head>


<body>

<div style="position: fixed; margin-top: 1.7%; height: 10vh; margin-left: 2.2%; margin-bottom: 1.5%" class="d-none d-sm-block d-md-block d-lg-block">
	<div class="title" align="left">
		<h1 style="font-size: 3vw; font-weight: bold; color: #49AC52; text-align: left;">
			
			<a href="index.html" style="color: inherit">
			Pave</a>
		</h1>
	</div>
</div>

	<div id="rightSide">
		
		<img style="opacity: 0.3; width: 47vw; position: fixed; right: 8vw; top: 6vw" id="background" src="img/logo.png">

	</div>

<div id="jobExample" width="100" height="100" style="position: fixed; left: 54vw; top: 21.3vw;">
    <svg height="100" width="100">
        <circle id="jobExampleCircle" cx="2.7vw" cy="2.4vw" r="1.95vw" fill="#FD7F27" />
    </svg>
</div>

<div class="d-inline" style="position: fixed; left: 12vw; top: 13vw; font-size: 1.4vw; font-weight: 600; color: #49AC52">
    <span id="eachCircleSpan" style="font-size: 3.05vw;">Each circle is a job group</span>
    <br>
    <br><span id="bruceSpanner" style="margin-left: 0.2vw; opacity: 1;">Hover over the circle on the right to see the details</span>
    <br>
    <br><span id="davidSpanner" style="margin-left: 0.2vw; opacity: 0;">Click the circle to see skills used on the job</span>

    <div id="nextDiv" style="position: fixed; left: 18.7vw; top: 35vw;">
        <a class="intro-tour-button btn-arrow-left" style="display: inline-block; width: 8vw; color: white; z-index: 99;" href="Tutorial1.html" id="prevLink">PREV</a>
        <a class="intro-tour-button btn-arrow-right" style="display: inline-block; width: 8vw; opacity: 0; color: white; z-index: 100" id="nextLink">NEXT</a>
    </div>

</div>

<script type="text/javascript" src="https://d3js.org/d3.v4.min.js"></script>

<script>
	var stretch_y = 1.7;
	var skillsBarsYtranslate = -15;
	var maxWage = 116.18;
	var clicked = 0;
	var d = {
		job: "Chemical plant machine operators",
		wage: 18,
		automationRisk: 0.76,
		yearsStudy: 2.4,
		cluster: 6,
		title1: "Chemical research technician",
		title2: "Mass spectrometer technician",
		title3: "Chemical technologist", 
		topSkill1: "Document Use", 	
		topSkill2: "Reading", 	
		topSkill3: "Writing", 	
		skillsLang: 44,
		skillsLogi: 28,
		skillsMath: 5,
		skillsComp: 29,
	};
	var jobYearsStudy = 3.4;
	var jobWage = 25;
	var jobAutomationRisk = 0.57

	var color = d3.scaleOrdinal()
	.domain(d3.range(10))
	.range([
		"#4B40DD",
		"#D42A2F",
		"#329E33",
		"#BCBC35",
		"#2678B2",
		"#FD7F27",
		"#FD7F27",
		"#7F7F7F",
		"#8B564C",
		"#29BECE",
		]);

	var colorTooltip = d3.scaleOrdinal()
	.domain([0,1,2,3,4,5,6,7,8,9])
    .range(["white", // blue
            "white", // orange
            "white", // green
            "white", // red
            "white", // purple
            "white", // brown
            "white", // pink
            "white", // grey
            "white", // yellow-green
            "white" ]) // teal

var colorTooltip2 = d3.scaleOrdinal()
    .domain([0,1,2,3,4,5,6,7,8,9])
    .range(["#3E35B5", // blue
            "#AE2327", // 
            "#29822A", // green
            "#9A9A2C", // red
            "#206392", // purple
            "#8C328C", // pink
            "#D06820", // orange
            "#686868", // grey
            "#72473F", // brown
            "#229CA9" ]) // teal

var colorSkillbar = d3.scaleOrdinal()
    .domain([0,1,2,3,4,5,6,7,8,9])
    .range(["#256D1B", // purple
            "#256D1B", // red
            "#244F26", // green
            "#256D1B", // red
            "#244F26", // blue
            "#256D1B", // pink
            "#256D1B", // orange
            "#256D1B", // grey
            "#256D1B", // brown
            "#256D1B" ]) // teal

var stretch_y = 1.7;
var compress_y = 0.7;
var skillsBarsXtranslate = -15;
var skillsBarsYtranslate = 80;

function pad(num, size) { // add leading 0s to nocs like 0011
    var s = num+"";
    while (s.length < size) s = "0" + s;
    return s;
}


// d3.select("body").on("click", function(d){
// console.log(d3.event.pageX)
//   // if (clicked == 1) { 
//     if (d3.event.pageX < window.innerWidth*0.5) { // if clicking the right half of the page
//   //     return
//   //   } else if (d3.event.target.nodeName == "svg") { clicked = 0
//     hideToolTip(500) }
//   // }
// })


function hideToolTip(duration) {
      // fade out each tooltip contents object
      div.transition().duration(duration).style("opacity",0)
      d3.select("#tooltip0").transition().duration(duration).style("opacity",0).remove()
      d3.select("#tooltip1").transition().duration(duration).style("opacity",0).remove()
      d3.select("#tooltip2").transition().duration(duration).style("opacity",0).remove()
      d3.select("#tooltip3").transition().duration(duration).style("opacity",0).remove()

      // shrink each tooltip div
      // d3.select("#tooltipBottomDiv").transition().duration(duration).style("height","0px").remove()
      // d3.select("#tooltipBottomDiv2").transition().duration(duration).style("height","0px").remove()
      
      d3.select("#tooltipBottomDiv2").transition().duration(duration).style("margin-top","-250px").style("opacity",0).remove()
      d3.select("#tooltipBottomDiv").transition().duration(duration).style("margin-top","-250px").style("opacity",0).remove()
      
      // fade the skill bar rects
      for (var i = 5; i < 9; i++) {
        d3.select("#rect"+i).transition().duration(duration).style("opacity",0).remove()
        d3.select("#rect"+i+"shadow").transition().duration(duration).style("opacity",0).remove()
      }

      // put the original tooltip on top
      d3.select("#moreBtnsContainerDiv").style("z-index","-1")
      d3.select("#moreBtnsDiv").style("z-index","-1")
      
      // shrink the more buttons div
      d3.select("#moreBtnsContainerDiv").transition().duration(300).style("width","20px").style("opacity",0).style("bottom","20px")
      d3.select("#moreBtnsDiv").transition().duration(180).style("opacity",0)
}

  var div = d3.select("body").append("div")
		.attr("class", "tooltip")
		.style("opacity", 0);

	d3.select("#jobExampleCircle")
	.on("mouseover", function(d) {
      if (clicked == 1) return;
      // highlight the current circle
      d3.select(this).attr("stroke", "black").attr("stroke-width", 3);
      tooltipMouseover(d);
      setTimeout(function() {
        d3.select("#davidSpanner").transition().duration(500).style("opacity",1)
      }, 500)
      setTimeout(function() {
        d3.select("#bruceSpanner").transition().duration(500).style("opacity",0.2)
        d3.select("#eachCircleSpan").transition().duration(500).style("opacity",0.2)
      }, 500)
      })
    .on("mouseout", function(d) {
      if (clicked == 1) return;

      // clicked = 0;
      d3.select(this).attr("stroke", "none");
      div.transition()
      .duration(500)
      .style("opacity", 0);
    })
    .on("click", function(d) {
      // click-on, click-off
      clicked = 1-clicked;
    if (clicked == 1) {
      tooltipLarge(d);
      setTimeout(function() {
        d3.select("#nextLink").transition().duration(500).style("opacity",1).attr("href","Tutorial3.html")
      }, 500)
     } else if (clicked == 0) {tooltipSmall(d);}
      })


function tooltipMouseover(){

	div.transition()
      .duration(300)
      .style("opacity", 1)
      .style("height", "auto")
      .style("width", "360px")
      .style("z-index", 99)
      .style("position", "absolute")
      // .style("border",   "1px solid black;");

      // d3.select("#tooltip")
      // .append("image")
      //   .attr("src", "img/logo.png")
      //   .attr("class", "img-rounded");

      // d3.select("#tooltip")
      // .append("image")
      //   .attr("src", "img/logo.png")
      //   .attr("class", "img-rounded");

      // Display Hover Tooltip
      div.html("<div style='z-index: 99; font-weight: bold; font-size: 20px; padding-top: 5px; padding-left: 10px; font-family: Raleway; color: " + colorTooltip(d.cluster)
        +"; font-weight: bold'>" + d.job + "</div>"
                +"<div id='tooltipContentPre' style='color: " + colorTooltip(d.cluster) +"; padding-left: 10px; font-size: 17px; font-family: Raleway;'>"
        
                +"<svg height='53px' style='margin: 10 0;' class='chart' aria-labelledby='title desc' role='img'>"+
                  "<title id='title'>A bar chart showing information</title>"+
                  "<g class='bar'>"+
                    "<rect width='"+(150*d.yearsStudy/5)+"' style='fill: #256D1B;' height='15'></rect>"+
                    "<text style='fill: " + colorTooltip(d.cluster) +"; font-family: Raleway' x='"+(150*d.yearsStudy/5+5)+"' y='9.5' dy='.35em'>"+Math.round(d.yearsStudy*10)/10+" years of study</text>"+
                  "</g>"+
                  "<g class='bar'>"+
                    "<rect width='"+(350*d.wage/maxWage)+"' style='fill: #244F26' height='15' y='20'></rect>"+
                    "<text style='fill: " + colorTooltip(d.cluster) +"; font-family: Raleway' x='"+(Math.round((350*d.wage/maxWage+5)*100)/100)+"' y='28' dy='.35em'>$ "+Math.round(d.wage*100)/100+" per hr</text>"+
                  "</g>"+
                  "<g class='bar'>"+
                    "<rect width='"+(150*d.automationRisk)+"' height='15' style='fill: #550C18' y='40'></rect>"+
                    "<text style='fill: " + colorTooltip(d.cluster) +"; font-family: Raleway' x='"+(150*d.automationRisk+5)+"' y='48' dy='.35em'>"+(Math.round(d.automationRisk*100))+"% risk of machine automation</text>"+
                  "</g>"+
                "</svg>"                                
                +"Top skills:</br>"
                +"<ul class='subtext' style='margin-top: 5px;'><li>" + d.topSkill1 + "</li><li>" + d.topSkill2 + "</li><li>" + d.topSkill3 + "</ul>"//TOP SKILLS
     +"<div id='tooltip3' style='border-bottom-left-radius: 6px; border-bottom-right-radius: 6px; margin-left: -12px; margin-bottom: -2px; margin-right: -2px; height: 15px; background: "+ colorTooltip2(d.cluster) +";'>"
                     // Skill minibars
        +"<svg id='miniBars' height='10px' style='position: absolute; margin-top: "+5+"px; margin-left: 25px;' class='chart' aria-labelledby='title desc' role='img'>"+
          "<title id='title'>A bar chart showing information</title>"+
          "<g class='bar'>"+
          // "<text style='fill: " + colorTooltip(d.cluster) +"; transform: rotate(-90deg); font-size: 16px; font-family: Raleway' x='-80' y='"+(-7-skillsBarsXtranslate)+"' dy='.35em'>Language</text>"+
          "<rect id='rect1' height='"+(d.skillsLang*compress_y)+"' width='18' style='fill: "+ colorSkillbar(d.cluster) +";' y='"+(skillsBarsYtranslate*0.25-(d.skillsLang*compress_y))+"' x='"+(5-skillsBarsXtranslate)+"'></rect>"+
          // "<text style='fill: " + colorTooltip(d.cluster) +"; transform: rotate(-90deg); font-family: Raleway' x='"+(-75)+"' y='"+(15-skillsBarsXtranslate)+"'>"+Math.round(10*d.skillsLang)/10+"</text>"+
          "</g>"+
          "<g class='bar'>"+
          // "<text style='fill: " + colorTooltip(d.cluster) +"; transform: rotate(-90deg); font-size: 16px; font-family: Raleway' x='-80' y='"+(30-skillsBarsXtranslate)+"' dy='.35em'>Logic</text>"+
          "<rect id='rect2' height='"+(d.skillsLogi*compress_y)+"' width='18' style='fill: "+ colorSkillbar(d.cluster) +";' y='"+(skillsBarsYtranslate*0.25-(d.skillsLogi*compress_y))+"' x='"+(40-skillsBarsXtranslate)+"'></rect>"+
          // "<text style='fill: " + colorTooltip(d.cluster) +"; transform: rotate(-90deg); font-family: Raleway' x='"+(-75)+"' y='"+(50-skillsBarsXtranslate)+"'>"+Math.round(10*d.skillsLogi)/10+"</text>"+
          "</g>"+
          "<g class='bar'>"+
          // "<text style='fill: " + colorTooltip(d.cluster) +"; transform: rotate(-90deg); font-size: 16px; font-family: Raleway' x='-80' y='"+(100-skillsBarsXtranslate)+"' dy='.35em'>Computer</text>"+
          "<rect id='rect4' height='"+(d.skillsComp*compress_y)+"' width='18' style='fill: "+ colorSkillbar(d.cluster) +";' y='"+(skillsBarsYtranslate*0.25-(d.skillsComp*compress_y))+"' x='"+(75-skillsBarsXtranslate)+"'></rect>"+
          // "<text style='fill: " + colorTooltip(d.cluster) +"; transform: rotate(-90deg); font-family: Raleway' x='"+(-75)+"' y='"+(120-skillsBarsXtranslate)+"'>"+Math.round(10*d.skillsComp)/10+"</text>"+
          "</g>"+
          "<g class='bar'>"+
          // "<text style='fill: " + colorTooltip(d.cluster) +"; transform: rotate(-90deg); font-size: 16px; font-family: Raleway' x='-80' y='"+(65-skillsBarsXtranslate)+"' dy='.35em'>Math</text>"+
          "<rect id='rect3' height='"+(d.skillsMath*compress_y)+"' width='18' style='fill: "+ colorSkillbar(d.cluster) +";' y='"+(skillsBarsYtranslate*0.25-(d.skillsMath*compress_y))+"' x='"+(110-skillsBarsXtranslate)+"'></rect>"+
          // "<text style='fill: " + colorTooltip(d.cluster) +"; transform: rotate(-90deg); font-family: Raleway' x='"+(-75)+"' y='"+(85-skillsBarsXtranslate)+"'>"+Math.round(10*d.skillsMath)/10+"</text>"+
          "</g>"+
        "</svg>"
        // +"<span id='clickSpan' style='position: absolute; right: 45px; bottom: -3px; color: white; font-size: 14px;'>&#9660&nbspclick&nbsp&#9660</span>"
        +"</div>")
        // Move div above mouse by "top" + radius and right by "left"
        .style("left", "58vw")
        .style("background", color(d.cluster) )
        .style("top", "10vw");
	}

function tooltipLarge() {
  div2 = div.append("div")
  .attr("id","tooltipBottomDiv").style("background",colorTooltip2(d.cluster))
  .style("height","0px").style("width","360px")
  .style("z-index",-1)
  .style("margin-left","-2px")
  .style("margin-bottom","-2px")
  .style("border-bottom-left-radius","6px")
  .style("border-bottom-right-radius","6px")
  .style("pointer-events","auto");

 
  d3.select("#miniBars").transition().duration(275)
  // .style("margin-top",250+"px")
  .style("opacity",0);
 
  var maxLength = 34
  //Some job titles from this group are...
  if(d.title1.length>maxLength){var title1 = d.title1.substring(0,maxLength) + "..."
  }else{var title1 = d.title1}
  if(d.title2.length>maxLength){var title2 = d.title2.substring(0,maxLength) + "..."
  }else{var title2 = d.title2}
  if(d.title3.length>maxLength){var title3 = d.title3.substring(0,maxLength) + "..."
  }else{var title3 = d.title3}

  setTimeout(function(){

    d3.select("#tooltipBottomDiv")
    .html("<div id='tooltipBottomDiv2' style=' z-index: -1; margin-top: -15px; border-bottom-left-radius: 6px; border-bottom-right-radius: 6px; font-size: 16px; padding-top: 5px; padding-left: 10px; font-family: Raleway; color: " + colorTooltip(d.cluster)
      +"; background: "+ colorTooltip2(d.cluster) +";'>"

        +"<span style='padding-left: 3px;'>Some job titles from this group are:</span></br>"
        +"<ul style='padding-top: 9px;'><li>"+title1+"</li><li>"+title2+"</li><li>"+title3+"</li></ul></div>"

      // Skill levels
        +"<svg height='80px' style='position: absolute; margin-top: "+(37)+"px; margin-left: 15px;' class='chart' aria-labelledby='title desc' role='img'>"+
        "<title id='title'>A bar chart showing information</title>"+

        "<g class='bar'>"+                                                                       // y = x if rotated 90deg
        "<rect id='rect5shadow' class='shadow' height='"+(d.skillsLang*stretch_y)+"' width='18' transform='translate(3,7)' style='box-shadow: 3px 3px 3px black; fill: #30352F;' y='"+(skillsBarsYtranslate-(d.skillsLang*stretch_y))+"' x='"+(5-skillsBarsXtranslate)+"'></rect>"+
        "<rect id='rect5' height='"+(d.skillsLang*stretch_y)+"' width='18' style='box-shadow: 3px 3px 3px black; fill: #256D1B;' y='"+(skillsBarsYtranslate-(d.skillsLang*stretch_y))+"' x='"+(5-skillsBarsXtranslate)+"'></rect>"+
        "<text class='subtext' style='fill: " + colorTooltip(d.cluster) +"; transform: rotate(-90deg); font-size: 16px; font-family: Raleway' x='-80' y='"+(-5-skillsBarsXtranslate)+"' dy='.35em'>"+
          "Language</text>"+
        // "<text class='subtext' style='fill: " + colorTooltip(d.cluster) +"; transform: rotate(-90deg); font-family: Raleway' x='"+(-75)+"' y='"+(17-skillsBarsXtranslate)+"'>"+
        //   Math.round(10*d.skillsLang)/10+"</text>"+
        "</g>"+
        "<g class='bar'>"+
        "<rect id='rect6shadow' class='shadow' height='"+(d.skillsLogi*stretch_y)+"' width='18' transform='translate(3,7)' style='box-shadow: 3px 3px 3px black; fill: #30352F;' y='"+(skillsBarsYtranslate-(d.skillsLogi*stretch_y))+"' x='"+(40-skillsBarsXtranslate)+"'></rect>"+
        "<rect id='rect6' height='"+(d.skillsLogi*stretch_y)+"' width='18' style='box-shadow: 3px 3px 3px black; fill: #256D1B;' y='"+(skillsBarsYtranslate-(d.skillsLogi*stretch_y))+"' x='"+(40-skillsBarsXtranslate)+"'></rect>"+
        "<text class='subtext' style='fill: " + colorTooltip(d.cluster) +"; transform: rotate(-90deg); font-size: 16px; font-family: Raleway' x='-80' y='"+(32-skillsBarsXtranslate)+"' dy='.35em'>"+
        "Logic</text>"+
        // "<text class='subtext' style='fill: " + colorTooltip(d.cluster) +"; transform: rotate(-90deg); font-family: Raleway' x='"+(-75)+"' y='"+(52-skillsBarsXtranslate)+"'>"+
        //   Math.round(10*d.skillsLogi)/10+"</text>"+
        "</g>"+
        "<g class='bar'>"+
        "<rect id='rect7shadow' class='shadow' height='"+(d.skillsComp*stretch_y)+"' width='18' transform='translate(3,7)' style='box-shadow: 3px 3px 3px black; fill: #30352F;' y='"+(skillsBarsYtranslate-(d.skillsComp*stretch_y))+"' x='"+(75-skillsBarsXtranslate)+"'></rect>"+
        "<rect id='rect7' height='"+(d.skillsComp*stretch_y)+"' width='18' style='box-shadow: 3px 3px 3px black; fill: #256D1B;' y='"+(skillsBarsYtranslate-(d.skillsComp*stretch_y))+"' x='"+(75-skillsBarsXtranslate)+"'></rect>"+
        "<text class='subtext' style='fill: " + colorTooltip(d.cluster) +"; transform: rotate(-90deg); font-size: 16px; font-family: Raleway' x='-80' y='"+(67-skillsBarsXtranslate)+"' dy='.35em'>Computer</text>"+
        // "<text class='subtext' style='fill: " + colorTooltip(d.cluster) +"; transform: rotate(-90deg); font-family: Raleway' x='"+(-75)+"' y='"+(87-skillsBarsXtranslate)+"'>"+Math.round(10*d.skillsComp)/10+"</text>"+
        "</g>"+
        "<g class='bar'>"+
        "<rect id='rect8shadow' class='shadow' height='"+(d.skillsMath*stretch_y)+"' width='18' transform='translate(3,7)' style='box-shadow: 3px 3px 3px black; fill: #30352F;' y='"+(skillsBarsYtranslate-(d.skillsMath*stretch_y))+"' x='"+(110-skillsBarsXtranslate)+"'></rect>"+
        "<rect id='rect8' height='"+(d.skillsMath*stretch_y)+"' width='18' style='box-shadow: 3px 3px 3px black; fill: #256D1B;' y='"+(skillsBarsYtranslate-(d.skillsMath*stretch_y))+"' x='"+(110-skillsBarsXtranslate)+"'></rect>"+
        "<text class='subtext' style='fill: " + colorTooltip(d.cluster) +"; transform: rotate(-90deg); font-size: 16px; font-family: Raleway' x='-80' y='"+(102-skillsBarsXtranslate)+"' dy='.35em'>Math</text>"+
        // "<text class='subtext' style='fill: " + colorTooltip(d.cluster) +"; transform: rotate(-90deg); font-family: Raleway' x='"+(-75)+"' y='"+(122-skillsBarsXtranslate)+"'>"+Math.round(10*d.skillsMath)/10+"</text>"+
        "</g>"+
        "</svg>"+
        // +"<br/>" 
        "<span style='margin-left: 231px'></span>"+
        "<span style='margin-top: 10px; margin-left: 220px'></span>"+
        "<button id='viewMoreBtn' class='btn btn-lg'"+
        "style='position: absolute; right: 17px; bottom: 20px; z-index: 999; box-shadow: 3px 3px 3px grey; font-size: 16px; font-weight: bold; margin-top: 11px; font-family: Raleway; background: white; color: " + color(d.cluster) +"'>"+
        "View more</button>"+"</div>")

    d3.select("#viewMoreBtn").on("click", function() {
        d3.select("#viewMoreBtn").transition().duration(500).style("opacity",0).remove()

        // d3.select("#tooltipBottomDiv").style("border-radius", "6px")
        // .transition().duration(500).style("width","550px")
        // .style("box-shadow","7px 7px 17px #404040FF")
        
        div3 = d3.select("#tooltipBottomDiv").append("div").attr("id","moreBtnsContainerDiv")
          .style("height","250px")
          .style("box-shadow","6px 4px 12px #404040FF")
          .style("border-top-right-radius","6px")
          .style("border-bottom-right-radius","6px")
          .style("background", colorTooltip2(d.cluster))
          .style("position","absolute")
          .style("left","160px")
          .style("bottom","0px")
          .style("z-index","-1")
          .html("<div id='moreBtnsDiv' align='right' style='margin-top: 0px; margin-left: 15px; margin-right: 15px;'>"+

        "<a id='btnJobBank' class='btn btn-sm' href='"+"http://noc.esdc.gc.ca/English/NOC/QuickSearch.aspx?ver=&val65="+pad(d.noc,4)+"' target='_blank' "+
        "style='margin-top: 20px; margin-bottom: 10px; box-shadow: 3px 3px 3px grey; font-size: 16px; font-weight: bold; font-family: Raleway; background: white; color: " + color(d.cluster) + "'>"+
        "JobBank Info Page</a><br>"+

        "<a id='btnVolunteer' class='btn btn-sm' "+
        "style='margin-bottom: 10px; box-shadow: 3px 3px 3px grey; font-size: 16px; font-weight: bold; font-family: Raleway; background: white; color: " + color(d.cluster) +
        "' target='_blank' href='"+"https://youth.volunteer.ca/"+"'>"+
        "Volunteer Canada</a><br>"+

        "<br><br><span style='margin-left: -20px; color: white;'>"+
        "View listings for this job:</span>"+

        "<div align='right' style='margin: 10px 0px 20px 0px'>"+
        "<a id='btnIndeed' class='btn btn-sm' "+
        "style='border-radius: 4px; margin-bottom: 10px; box-shadow: 3px 3px 3px grey; font-size: 16px; font-weight: bold; font-family: Raleway; background: white; color: " + color(d.cluster) +
        "' target='_blank' href='"+"https://www.indeed.ca/jobs?q="+d.job+"'>"+
        "&nbspIndeed.ca&nbsp</a><br>"+

        "<a id='btnGlassdoor' class='btn btn-sm' "+
        "style='border-radius: 4px; margin-bottom: 10px; box-shadow: 3px 3px 3px grey; font-size: 16px; font-weight: bold; font-family: Raleway; background: white; color: " + color(d.cluster) +
        "' target='_blank' href='"+"https://www.glassdoor.ca/Job/"+d.job.split(' ').join('-')+"-jobs-SRCH_KO0,19.htm'>"+
        "&nbspGlassdoor.ca&nbsp</a><br>"+

        "<a id='btnMonster' class='btn btn-sm' "+
        "style='border-radius: 4px; margin-bottom: 10px; box-shadow: 3px 3px 3px grey; font-size: 16px; font-weight: bold; font-family: Raleway; background: white; color: " + color(d.cluster) +
        "' target='_blank' href='"+"https://www.monster.ca/jobs/search/?q="+d.job.split(' ').join('-')+"'>"+
        "&nbspMonster.ca&nbsp</a><br>"+

        "</div></div>")
          
        div3.transition().duration(350).style("left","360px").style("height","360px")

        d3.select("#moreBtnsDiv").style("opacity",0).transition().duration(350).style("opacity",1).style("left","360px")
    })

   }, 275);

  // skill bars
  d3.select("#tooltipBottomDiv").append("svg")
  .attr("height","280px").style("position","absolute").style("margin-left","25px")
  .append("rect").attr("height",(d.skillsLang*compress_y)).attr("width","18")
  .style("fill",colorSkillbar(d.cluster))
  .attr("y",(skillsBarsYtranslate*0.25-(d.skillsLang*compress_y))).attr("x",(5-skillsBarsXtranslate))
  .transition().duration(275)
    .attr("height", (d.skillsLang*stretch_y))
    .attr("y",150)

  d3.select("#tooltipBottomDiv").append("svg")
  .attr("height","280px").style("position","absolute").style("margin-left","25px")
  .append("rect").attr("height",(d.skillsLogi*compress_y)).attr("width","18")
  .style("fill",colorSkillbar(d.cluster))
  .attr("y",(skillsBarsYtranslate*0.25-(d.skillsLogi*compress_y))).attr("x",(40-skillsBarsXtranslate))
  .transition().duration(275)
    .attr("height", (d.skillsLogi*stretch_y))
    .attr("y",150)  

  d3.select("#tooltipBottomDiv").append("svg")
  .attr("height","280px").style("position","absolute").style("margin-left","25px")
  .append("rect").attr("height",(d.skillsComp*compress_y)).attr("width","18")
  .style("fill",colorSkillbar(d.cluster))
  .attr("y",(skillsBarsYtranslate*0.25-(d.skillsComp*compress_y))).attr("x",(75-skillsBarsXtranslate))
  .transition().duration(275)
    .attr("height", (d.skillsComp*stretch_y))
    .attr("y",150)  

  d3.select("#tooltipBottomDiv").append("svg")
  .attr("height","280px").style("position","absolute").style("margin-left","25px")
  .append("rect").attr("height",(d.skillsMath*compress_y)).attr("width","18")
  .style("fill",colorSkillbar(d.cluster))
  .attr("y",(skillsBarsYtranslate*0.25-(d.skillsMath*compress_y))).attr("x",(110-skillsBarsXtranslate))
  .transition().duration(275)
    .attr("height", (d.skillsMath*stretch_y))
    .attr("y",150)

  // d3.select("#tooltipBottomDiv2").transition().duration(250).style("height", "2800px");
  // d3.select("#tooltipBottomDiv").transition().duration(250).style("height", "2802px");
  div2.transition().duration(250).style("height","250px");

        // Unfurl downward
        // .style("height", 200)
        // .transition()
        // .duration(200)
        // .style("height", "auto")
       // d3.select("#tooltipContent").transition().duration(250).style("height", "auto");



     };

function tooltipSmall() {
  d3.select("#tooltipContent").transition().duration(250).style("height", "100px");
      setTimeout(function() {
              div.html("<div style='z-index: 99; font-weight: bold; font-size: 20px; padding-top: 5px; padding-left: 10px; font-family: Raleway; color: " + colorTooltip(d.cluster)
        +"; font-weight: bold'>" + d.job + "</div>"
                +"<div id='tooltipContentPre' style='color: " + colorTooltip(d.cluster) +"; padding-left: 10px; font-size: 15px; font-family: Raleway;'>"
        
                +"<svg height='82px' style='margin: 10 0;' class='chart' aria-labelledby='title desc' role='img'>"+
                  "<title id='title'>A bar chart showing information</title>"+
                  "<g class='bar'>"+
                    "<rect width='"+(150*d.yearsStudy/5)+"' style='fill: #256D1B;' height='15'></rect>"+
                    "<text style='fill: " + colorTooltip(d.cluster) +"; font-family: Raleway' x='"+(150*d.yearsStudy/5+5)+"' y='9.5' dy='.35em'>"+Math.round(d.yearsStudy*10)/10+" years of study</text>"+
                  "</g>"+
                  "<g class='bar'>"+
                    "<rect width='"+(350*d.wage/maxWage)+"' style='fill: #244F26' height='15' y='20'></rect>"+
                    "<text style='fill: " + colorTooltip(d.cluster) +"; font-family: Raleway' x='"+(Math.round((350*d.wage/maxWage+5)*100)/100)+"' y='28' dy='.35em'>$ "+Math.round(d.wage*100)/100+" per hr</text>"+
                  "</g>"+
                  "<g class='bar'>"+
                    "<rect width='"+(150*d.automationRisk)+"' height='15' style='fill: #550C18' y='40'></rect>"+
                    "<text style='fill: " + colorTooltip(d.cluster) +"; font-family: Raleway' x='"+(150*d.automationRisk+5)+"' y='48' dy='.35em'>"+(Math.round(d.automationRisk*100))+"% risk of machine automation</text>"+
                  "</g>"+
                "</svg>"                                
                +"<br/><span style='padding-left: 3px;'>Some job titles from this group are ...</span></br>"
                +"<ul style='padding-top: 9px;'><li>"+d.title1+"</li><li>"+d.title2+"</li><li>"+d.title3+"</li></ul></div>")}, 150)
}

</script>

</body>

</html>  		

